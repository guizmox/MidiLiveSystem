using System;
using RtMidi.Core.Enums.Core;

namespace RtMidi.Core.Enums
{
    public enum Key
    {
        [EnumDisplayName("Key 0")] Key0,
        [EnumDisplayName("Key 1")] Key1,
        [EnumDisplayName("Key 2")] Key2,
        [EnumDisplayName("Key 3")] Key3,
        [EnumDisplayName("Key 4")] Key4,
        [EnumDisplayName("Key 5")] Key5,
        [EnumDisplayName("Key 6")] Key6,
        [EnumDisplayName("Key 7")] Key7,
        [EnumDisplayName("Key 8")] Key8,
        [EnumDisplayName("Key 9")] Key9,
        [EnumDisplayName("Key 10")] Key10,
        [EnumDisplayName("Key 11")] Key11,
        [EnumDisplayName("Key 12")] Key12,
        [EnumDisplayName("Key 13")] Key13,
        [EnumDisplayName("Key 14")] Key14,
        [EnumDisplayName("Key 15")] Key15,
        [EnumDisplayName("Key 16")] Key16,
        [EnumDisplayName("Key 17")] Key17,
        [EnumDisplayName("Key 18")] Key18,
        [EnumDisplayName("Key 19")] Key19,
        [EnumDisplayName("Key 20")] Key20,
        [EnumDisplayName("Key 21")] Key21,
        [EnumDisplayName("Key 22")] Key22,
        [EnumDisplayName("Key 23")] Key23,
        [EnumDisplayName("Key 24")] Key24,
        [EnumDisplayName("Key 25")] Key25,
        [EnumDisplayName("Key 26")] Key26,
        [EnumDisplayName("Key 27")] Key27,
        [EnumDisplayName("Key 28")] Key28,
        [EnumDisplayName("Key 29")] Key29,
        [EnumDisplayName("Key 30")] Key30,
        [EnumDisplayName("Key 31")] Key31,
        [EnumDisplayName("Key 32")] Key32,
        [EnumDisplayName("Key 33")] Key33,
        [EnumDisplayName("Key 34")] Key34,
        [EnumDisplayName("Key 35")] Key35,
        [EnumDisplayName("Key 36")] Key36,
        [EnumDisplayName("Key 37")] Key37,
        [EnumDisplayName("Key 38")] Key38,
        [EnumDisplayName("Key 39")] Key39,
        [EnumDisplayName("Key 40")] Key40,
        [EnumDisplayName("Key 41")] Key41,
        [EnumDisplayName("Key 42")] Key42,
        [EnumDisplayName("Key 43")] Key43,
        [EnumDisplayName("Key 44")] Key44,
        [EnumDisplayName("Key 45")] Key45,
        [EnumDisplayName("Key 46")] Key46,
        [EnumDisplayName("Key 47")] Key47,
        [EnumDisplayName("Key 48")] Key48,
        [EnumDisplayName("Key 49")] Key49,
        [EnumDisplayName("Key 50")] Key50,
        [EnumDisplayName("Key 51")] Key51,
        [EnumDisplayName("Key 52")] Key52,
        [EnumDisplayName("Key 53")] Key53,
        [EnumDisplayName("Key 54")] Key54,
        [EnumDisplayName("Key 55")] Key55,
        [EnumDisplayName("Key 56")] Key56,
        [EnumDisplayName("Key 57")] Key57,
        [EnumDisplayName("Key 58")] Key58,
        [EnumDisplayName("Key 59")] Key59,
        [EnumDisplayName("Key 60")] Key60,
        [EnumDisplayName("Key 61")] Key61,
        [EnumDisplayName("Key 62")] Key62,
        [EnumDisplayName("Key 63")] Key63,
        [EnumDisplayName("Key 64")] Key64,
        [EnumDisplayName("Key 65")] Key65,
        [EnumDisplayName("Key 66")] Key66,
        [EnumDisplayName("Key 67")] Key67,
        [EnumDisplayName("Key 68")] Key68,
        [EnumDisplayName("Key 69")] Key69,
        [EnumDisplayName("Key 70")] Key70,
        [EnumDisplayName("Key 71")] Key71,
        [EnumDisplayName("Key 72")] Key72,
        [EnumDisplayName("Key 73")] Key73,
        [EnumDisplayName("Key 74")] Key74,
        [EnumDisplayName("Key 75")] Key75,
        [EnumDisplayName("Key 76")] Key76,
        [EnumDisplayName("Key 77")] Key77,
        [EnumDisplayName("Key 78")] Key78,
        [EnumDisplayName("Key 79")] Key79,
        [EnumDisplayName("Key 80")] Key80,
        [EnumDisplayName("Key 81")] Key81,
        [EnumDisplayName("Key 82")] Key82,
        [EnumDisplayName("Key 83")] Key83,
        [EnumDisplayName("Key 84")] Key84,
        [EnumDisplayName("Key 85")] Key85,
        [EnumDisplayName("Key 86")] Key86,
        [EnumDisplayName("Key 87")] Key87,
        [EnumDisplayName("Key 88")] Key88,
        [EnumDisplayName("Key 89")] Key89,
        [EnumDisplayName("Key 90")] Key90,
        [EnumDisplayName("Key 91")] Key91,
        [EnumDisplayName("Key 92")] Key92,
        [EnumDisplayName("Key 93")] Key93,
        [EnumDisplayName("Key 94")] Key94,
        [EnumDisplayName("Key 95")] Key95,
        [EnumDisplayName("Key 96")] Key96,
        [EnumDisplayName("Key 97")] Key97,
        [EnumDisplayName("Key 98")] Key98,
        [EnumDisplayName("Key 99")] Key99,
        [EnumDisplayName("Key 100")] Key100,
        [EnumDisplayName("Key 101")] Key101,
        [EnumDisplayName("Key 102")] Key102,
        [EnumDisplayName("Key 103")] Key103,
        [EnumDisplayName("Key 104")] Key104,
        [EnumDisplayName("Key 105")] Key105,
        [EnumDisplayName("Key 106")] Key106,
        [EnumDisplayName("Key 107")] Key107,
        [EnumDisplayName("Key 108")] Key108,
        [EnumDisplayName("Key 109")] Key109,
        [EnumDisplayName("Key 110")] Key110,
        [EnumDisplayName("Key 111")] Key111,
        [EnumDisplayName("Key 112")] Key112,
        [EnumDisplayName("Key 113")] Key113,
        [EnumDisplayName("Key 114")] Key114,
        [EnumDisplayName("Key 115")] Key115,
        [EnumDisplayName("Key 116")] Key116,
        [EnumDisplayName("Key 117")] Key117,
        [EnumDisplayName("Key 118")] Key118,
        [EnumDisplayName("Key 119")] Key119,
        [EnumDisplayName("Key 120")] Key120,
        [EnumDisplayName("Key 121")] Key121,
        [EnumDisplayName("Key 122")] Key122,
        [EnumDisplayName("Key 123")] Key123,
        [EnumDisplayName("Key 124")] Key124,
        [EnumDisplayName("Key 125")] Key125,
        [EnumDisplayName("Key 126")] Key126,
        [EnumDisplayName("Key 127")] Key127
    }

    public static class KeyExtensions
    {
        /// <summary>
        /// Get key octave (0-11)
        /// </summary>
        /// <returns>Octave</returns>
        public static int Octave(this Key key)
        {
            var keyValue = (int)key;
            if (keyValue < 0 || keyValue > 127)
                throw new ArgumentOutOfRangeException(nameof(key));

            // 12 notes per octave
            return keyValue / 12;
        }

        /// <summary>
        /// Get key note (C-B)
        /// </summary>
        /// <returns>Note</returns>
        public static Note Note(this Key key)
        {
            var keyValue = (int)key;
            if (keyValue < 0 || keyValue > 127)
                throw new ArgumentOutOfRangeException(nameof(key));

            return (Note)(keyValue % 12);
        }

        /// <summary>
        /// Get human readable display name of Key
        /// </summary>
        public static string DisplayName(this Key key) => EnumExtensions.GetDisplayNameAttribute(key)?.Name??string.Empty;
    }
}
